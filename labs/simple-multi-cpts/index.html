<!doctype html> <html class="no-js" lang="en"> <head>  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700|Open+Sans:400,300"> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Simple Multi CPT's. // Constantine Kiriaze // Web Engineer & Consultant</title> <meta name="description" content="Simple Multi Custom Post Types - A plugin that can handle multiple custom post types at once through an array, theme hookable yo."> <meta name="keywords" content="code, wordpress">  <meta name="viewport" content="width=device-width,initial-scale=1">   <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="/assets/images/"> <meta name="twitter:title" content="Simple Multi CPT's."> <meta name="twitter:description" content="A plugin that can handle multiple custom post types at once through an array, theme hookable yo."> <meta name="twitter:creator" content="@kiriaze">  <link rel="icon" type="image/png" href="/favicon.ico"> <!--[if (gte IE 6)&(lte IE 8)]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
		<script src="//cdnjs.cloudflare.com/ajax/libs/selectivizr/1.0.2/selectivizr-min.js"></script><![endif]-->   <link rel="stylesheet" href="/assets/css/main.min.css">  <link rel="canonical" href="/labs/simple-multi-cpts/"> <link rel="alternate" type="application/rss+xml" title="Constantine Kiriaze" href="/feed.xml"> </head> <body class=""> <main id="main"> <header role="banner" id="header" class="wow fadeIn" data-wow-delay=".4s"> <div class="container"> <a href="/" class="logo js-ajax-link" data-body-class="home-page"> Kiriaze </a> <input type="checkbox" id="drawer-toggle" name="drawer-toggle" class="nav-trigger"> <a href="#navicon" id="navicon"> <div class="line line-one"></div> <div class="line line-two"></div> <div class="line line-three"></div> </a> </div> </header> <div class="menu-overlay"> <div class="container"> <nav> <ul class="site-nav"> <li class="site-nav-item"> <a href="/about" class="js-ajax-link">Bio.</a> </li> <li class="site-nav-item"> <a href="/labs" class="current js-ajax-link">Labs.</a> </li> <li class="site-nav-item"> <a href="/work" class="js-ajax-link">Work.</a> </li> <li class="site-nav-item"> <a href="/blog" class="js-ajax-link">Words.</a> </li> </ul> </nav> <div class="contact-details"> <ul class="contact-info"> <li><a href="https://www.linkedin.com/in/constantinekiriaze">Resume</a></li> <li><span>San Diego, CA</span></li> <li><a href="mailto:hello@kiriaze.com">hello@kiriaze.com</a></li> </ul> <ul class="social-list"> <li><a href="http://github.com/kiriaze" target="new"><i class="fa fa-github"></i></a></li> <li><a href="http://dribbble.com/kiriaze" target="new"><i class="fa fa-dribbble"></i></a></li> <li><a href="http://twitter.com/kiriaze" target="new"><i class="fa fa-twitter"></i></a></li> <li><a href="https://www.linkedin.com/in/constantinekiriaze"><i class="fa fa-linkedin"></i></a></li> <li><a href="mailto:hello@kiriaze.com"><i class="fi fi-mail"></i></a></li> </ul> </div> </div> </div>     <section class="hero hero-mod grey-bg" data-midnight="default"> <div class="container hero-blurb"> <h1 class="title wow fadeIn" data-wow-delay=".6s">Simple Multi CPT's.</h1> <h6 class="subtitle wow fadeIn" data-wow-delay=".8s">A plugin that can handle multiple custom post types at once through an array, theme hookable yo.</h6> <div class="post-meta wow fadeIn" data-wow-delay="1s"> <span class="date">07.30.2015</span> <span class="categories"> <a href="/categories/#labs" title="Pages categorized in labs" class="cat"><span class="term">labs</span></a> <a href="/categories/#" title="Pages categorized in " class="cat"><span class="term"></span></a> </span> <span class="tags"> <a href="/tags/#code" title="Pages tagged code" class="tag"><span class="term">code</span></a>, <a href="/tags/#wordpress" title="Pages tagged wordpress" class="tag"><span class="term">wordpress</span></a>. </span> <span class="entry-reading-time"> <i class="fa fa-clock-o"></i> 3 minutes </span> </div>  </div> </section> <section class="post-content"> <div class="container"> <p class="text-align-center">Simple Multi Custom Post Types - A plugin that can handle multiple custom post types at once through an array, theme hookable yo.</p> <p class="text-align-center"><a href="http://github.com/kiriaze/simple-multi-cpts" class="btn">Get it here!</a></p> <hr> <h2 id="updates-galore">Updates Galore!</h2> <ol> <li>Multiple taxonomies can now be passed to each cpt, supports arrays.</li> <li>Ability to filter/sort them, as well as post type term count.</li> <li>Hide taxonomies backend table row header and filter/sort dropdowns through $hide[];</li> <li>Custom post type icons from FontAwesome!</li> <li>ACF Settings integration, now managable from wp admin instead of through functions file, or both if desired! Woot woot!</li> </ol> <hr> <h2 id="what">What?</h2> <p>A plugin that can handle multiple custom post types at once, requires atleast the singular and plural name of each cpt you would like to add, and optionally a custom taxonomy, slug rewrite, hide options, and icon.</p> <p>Following the philosophy of keeping custom post types theme agnostic, this plugin is lightweight and efficient and allows for adding infinite custom post types/taxonomies through wp admin ( Requires ACF ) or by hooking into the function within your theme, look at example below. This chunk is small enough to be easily placed within any theme - and is preferred over having multiple cpt plugins cluttering and slowing down your project.</p> <hr> <h2 id="why">Why?</h2> <p>Came across a project requiring a ridiculous amount of custom post types, and didnâ€™t think that having over 10 separate plugins for handling those post types were ideal - so I made one to rule them all. ba-dum-dum-tshh.</p> <hr> <h2 id="how">How?</h2> <ol> <li>Download/Clone/Composer that ish, install and activate plugin.</li> <li>ACF active? ( And it should be guys! )</li> <li>Skip the rest and head to the plugin settings page, else continue.</li> <li>If not, place hook into theme functions. ( Preferably into abstracted module, look @ simple. ) Note: Capitalise first letter.</li> <li>Notice how not every post type needs a tax or rewrite, however since this plugin works in array association, you will need to add an empty string for that relation. Allows for an array of multiple taxonomies to be passed to each cpt.</li> </ol> <p><br></p> <pre><code class="language-php">// hook into simple multi cpts
add_filter( 'simple_multi_cpts_plugin_init', 'simple_child_cpts' );
function simple_child_cpts() {

    global $child_cpts;

    // Required
    $cpt_name = array(
        'Agency',
        'Client',
        'Project'
    );

    // Required
    $cpt_plural = array(
        'Agencies',
        'Clients',
        'Projects'
    );

    // Optional
    $cpt_tax = array(
        'Locations',
        '',
        array('Type', 'Url', 'Skills')
    );

    // Optional
    $rewriteUrl = array(
        'Agencies',
        '',
        'Work'
    );

    // Optional - set to true to hide from backend
    $hide = array(
        '',
        true,
        array(
            '',
            true,
            ''
        )
    );

    // Optional -  post type icons, e.g. unicode stripped to \f037
    $cpt_icon = array(
        '\f037',
    );

    $child_cpts = array($cpt_name, $cpt_plural, $cpt_tax, $rewriteUrl, $hide, $cpt_icon);

    return $child_cpts;

}
</code></pre> <hr> <h2 id="look-at">Look at</h2> <noscript><pre>// Creates shared global tazonomies from an array,
// and assigns them to all cpts
add_action( &#39;init&#39;, &#39;create_shared_taxonomies&#39;, 11 );
function create_shared_taxonomies() {

	global $taxonomies;

	$sharedTaxonomies = array(
		&#39;vertical&#39;,
		&#39;solutions&#39;,
		&#39;region&#39;,
		&#39;product&#39;
	);

	$taxonomies = array();
	foreach ( $sharedTaxonomies as $tax ) :
		$taxonomies[] = array(
	        $tax         =&gt; array(
	            &#39;object_type&#39;                   =&gt; &#39;post&#39;, // set them all to post
	            &#39;label&#39;                         =&gt; ucfirst($tax),
	            &#39;labels&#39;                        =&gt; array(
	                    &#39;name&#39;                      =&gt; ucfirst($tax),
	                    &#39;singluar_name&#39;             =&gt; ucfirst($tax),
	                ),
	            &#39;public&#39;                        =&gt; true,
	            &#39;show_in_nav_menus&#39;             =&gt; false,
	            &#39;show_ui&#39;                       =&gt; true,
	            &#39;show_tagcloud&#39;                 =&gt; false,
	            &#39;hierarchical&#39;                  =&gt; true,
	            &#39;rewrite&#39;                       =&gt; array(&#39;slug&#39; =&gt; $tax),
	            &#39;link_to_post_type&#39;             =&gt; false,
	            &#39;post_type_link&#39;                =&gt; null,
	            &#39;has_archive&#39;                   =&gt; true
	        )
	    );
	endforeach;

	// sp($taxonomies);

    global $association_array;
    $association_array = array();

    foreach ( $taxonomies as $taxonmy ) {

    	// sp($taxonmy);
    	foreach ($taxonmy as $key =&gt; $value) {
    		// sp($value);
    		register_taxonomy( $key, $value[&#39;object_type&#39;], $value );

	        if ( $value[&#39;link_to_post_type&#39;] )
	        $association_array[$key] = $value[&#39;post_type_link&#39;];

		    $post_types = get_post_types( array(
		        &#39;_builtin&#39;  =&gt;  false // only custom post types
		    ), &#39;names&#39; );

		    foreach ( $post_types as $post_type ) {
				if ( $post_type == &#39;acf-field-group&#39; || $post_type == &#39;acf-field&#39; ) {
					unset($post_type); // removes acf from array
					continue;
				} else {
					register_taxonomy_for_object_type( $key, $post_type );

					// remove category and post tags from all custom post types
		    			global $wp_taxonomies;
					$wp_taxonomies[&#39;category&#39;]-&gt;object_type = array_diff( $wp_taxonomies[&#39;category&#39;]-&gt;object_type, array($post_type) );
					$wp_taxonomies[&#39;post_tag&#39;]-&gt;object_type = array_diff( $wp_taxonomies[&#39;post_tag&#39;]-&gt;object_type, array($post_type) );
				}
			}
    	}

    }


}</pre></noscript> <script src="https://gist.github.com/kiriaze/1ba01fd6f4287766922f.js"></script><noscript><pre>// remove tags/categories for &#39;post&#39; post type
add_action( &#39;init&#39;, &#39;my_taxonomy_cleanup&#39;, 11 );
function my_taxonomy_cleanup() {
	global $wp_taxonomies;
	$cpts = array(
		&#39;post&#39;, // individual cpt names
	);
	$wp_taxonomies[&#39;category&#39;]-&gt;object_type = array_diff( $wp_taxonomies[&#39;category&#39;]-&gt;object_type, $cpts );
	$wp_taxonomies[&#39;post_tag&#39;]-&gt;object_type = array_diff( $wp_taxonomies[&#39;post_tag&#39;]-&gt;object_type, $cpts );
}</pre></noscript> <script src="https://gist.github.com/kiriaze/f4c4664889a21731fecf.js"></script><hr> <h2 id="to-dos">To Doâ€™s</h2> <ol> <li>Optimize Code</li> <li>Some code is inconsistent, flush out.</li> <li>Nested forloops not ideal, look at index based comparison of arrays.</li> <li>Integrate new structure/philosophy into other simple plugins</li> </ol> <p><br></p> <pre><code class="language-php">// note: look into passing array differently
// like so:
[camper] =&gt; Array
    (
        [cpt_plural] =&gt; Campers
        [rewriteUrl] =&gt; Hikers
        [cpt_tax] =&gt; Array
            (
                [0] =&gt; Level
            )

        [hide] =&gt; Array
            (
                [0] =&gt;
            )

        [cpt_icon] =&gt; \f0fc
    )
</code></pre> <hr> <div id="disqus_thread"></div> <script type="text/javascript">var disqus_shortname="kiriaze",disqus_identifier="/labs/simple-multi-cpts/";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}(),function(){var e=document.createElement("script");e.async=!0,e.type="text/javascript",e.src="//"+disqus_shortname+".disqus.com/count.js",(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(e)}();</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript> </div> </section> <a href="/labs/s-grams/" title="next Post:S-Grams." class="next-post-alt js-ajax-link"> <div class="container"> <h6>Explore Another Post</h6> <h2>S-Grams.</h2> </div> <div class="hero-bg" style="background-image:url();background-position:center center"></div> </a> <footer role="contentinfo" id="footer"> <div class="container"> <div class="row"> <a href="/" class="logo js-ajax-link">K</a> <ul class="social-list"> <li><a href="http://github.com/kiriaze" target="new"><i class="fa fa-github"></i></a></li> <li><a href="http://dribbble.com/kiriaze" target="new"><i class="fa fa-dribbble"></i></a></li> <li><a href="http://twitter.com/kiriaze" target="new"><i class="fa fa-twitter"></i></a></li> <li><a href="mailto:hello@kiriaze.com"><i class="fi fi-mail"></i></a></li> </ul> </div> </div> </footer> <script src="/assets/js/app.min.js"></script><script type="text/javascript" src="//js.leadin.com/js/v1/1630440.js" id="LeadinEmbed-1630440" crossorigin="use-credentials" async defer></script><script type="text/javascript">var searchInput=document.getElementById("search-input");"undefined"!=typeof searchInput&&null!=searchInput&&SimpleJekyllSearch({searchInput:document.getElementById("search-input"),resultsContainer:document.getElementById("results-container"),json:"/search.json",searchResultTemplate:'<li><a href="{url}" title="{title}"><span>{category}</span>{title}<span>{desc}</span></a></li>',noResultsText:"No results found",limit:10,fuzzy:!0,exclude:[]});</script><script>!function(e,a,n,t,i,c,s){e.GoogleAnalyticsObject=i,e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].l=1*new Date,c=a.createElement(n),s=a.getElementsByTagName(n)[0],c.async=1,c.src=t,s.parentNode.insertBefore(c,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-65559123-1","auto"),ga("require","linkid","linkid.js"),ga("send","pageview");</script></main></body></html>